# 実装内容

Mixed-Solvent Molecular Dynamics (MSMD) は、タンパク質と複数の溶媒分子（プローブ）の相互作用を解析するための分子動力学シミュレーション手法です。

## MSMDの基本

MSMDでは、以下の特徴を持つ分子動力学シミュレーションを実行します。

1. 系の中に複数のプローブ分子（溶媒分子）が存在する
2. プローブ分子間に仮想的な反発力が働いている
3. 比較的短いシミュレーションを複数回実行し、その結果を統合する

### プローブ分子

プローブ分子とは、MSMDにおける解析用分子であり、ベンゼン、イソプロパノール等のような、極めて小さな有機化合物が採用されます。このプローブ分子がタンパク質と相互作用することで、タンパク質の構造変化の促進（cryptic結合部位探索）や、タンパク質表面上の分子の結合の解析（ホットスポット解析、結合親和性予測）などを行うことが出来ます。

### プローブ分子間の仮想的な反発力

しばしば、疎水的なプローブ分子を利用することがあり、そのような場合にはプローブ分子が凝集してしまいます。
このような問題を解決するため、プローブ分子間に仮想的な反発力を導入します。

プローブ分子間の仮想反発力は、Lennard-Jonesポテンシャルを用いて表現されます。

1. 各プローブ分子の重心に仮想原子 VIS を配置する
2. 仮想原子 VIS 同士の間にLennard-Jonesポテンシャルを適用する

$U_{LJ}(r) = 4\epsilon_{LJ} \left[ \left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^{6} \right]$

- $\epsilon_{LJ} = 10^{-6} \mathrm{kcal/mol}$
- $R_{min} = 20.0 \mathrm{\AA}$ ($\sigma = R_{min}/2^{1/6}$)

この設定は、Guvenchらの研究[^1] で示されていたプローブ分子の炭素原子間距離をよく再現するようなパラメータを手動で探索し、定めたものになっています。

[^1]: Olgun Guvench and Alexander D. MacKerell Jr. "Computational Fragment-Based Binding Site Identification by Ligand Competitive Saturation", *PLoS Computational Biology*, **5**: e1000435, 2009. DOI: [10.1371/journal.pcbi.1000435](https://doi.org/10.1371/journal.pcbi.1000435)


## MSMDシミュレーションプロトコル

MSMDでは、以下の手順のシミュレーションを複数回、系の初期構造を変化させながら行います。

### エネルギー最小化
系の中に存在している歪みを多少解消するために、最急降下法によるエネルギー最小化を行います。
この際、まずは位置拘束を加えた状態で最小化を行い、次に拘束を解除して最小化を行います。

### 系の加熱
系を目的の温度まで加熱します。

- NVTアンサンブル
- タンパク質に位置拘束
- 温度を徐々に上昇

### 位置拘束の段階的緩和
ここから先は、平衡化ステップとして、位置拘束を段階的に緩和していきます。

1. 初期の強い拘束から開始（1000 kcal/mol/Å²）
2. 段階的に拘束を弱める
3. 最終的に拘束を完全に解放

拘束の強さは以下に示すような段階で変化します。

1. 1000 kcal/mol/Å²
2. 500 kcal/mol/Å²
3. 200 kcal/mol/Å²
4. 100 kcal/mol/Å²
5. 50 kcal/mol/Å²
6. 20 kcal/mol/Å²
7. 10 kcal/mol/Å²
8. 0 kcal/mol/Å²

これらは圧力一定（NPTアンサンブル）で行われます。

### プロダクションラン
最終的なシミュレーションを実行します。

- NPTアンサンブル
- 位置拘束なし
- 一定時間のシミュレーション（標準：40 ns）
